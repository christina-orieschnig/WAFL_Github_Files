{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 1,
   "metadata": {},
   "outputs": [],
   "source": [
    "# this script analyzes inundation extents and relates them to water levels at Koh Khel \n",
    "\n",
    "# source of inundation extents: GEE script: https://code.earthengine.google.com/404c1fd0dcc9708cff48914f1370b90c"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "metadata": {},
   "outputs": [],
   "source": [
    "# import necessary packages\n",
    "import pandas as pd\n",
    "import numpy as np\n",
    "from sklearn.linear_model import LinearRegression\n",
    "import matplotlib.pyplot as plt\n",
    "import datetime\n",
    "import os\n",
    "import matplotlib.pyplot as plt\n",
    "import matplotlib.dates as mdates\n",
    "from matplotlib.dates import DateFormatter\n",
    "from pandas.plotting import register_matplotlib_converters\n",
    "register_matplotlib_converters()\n",
    "import math\n",
    "from matplotlib.dates import date2num"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "metadata": {},
   "outputs": [],
   "source": [
    "# Calculate Flood Extents\n",
    "\n",
    "radarfilename = 'Radar_2div_KMeans_2C.csv' #<---------- change study area + classifier\n",
    "opticalfilename = 'Sentinel_2div_KMeans_2C.csv'  #<---------- change study area + classifier\n",
    "\n",
    "## optical data \n",
    "\n",
    "op =pd.read_csv(opticalfilename)\n",
    "\n",
    "op['date'] = pd.to_datetime(op['date'])\n",
    "\n",
    "minimum_area = op['totalarea'].max()*0.95\n",
    "\n",
    "op = op[op['totalarea'] > minimum_area]\n",
    "\n",
    "op['flooded'] = 100*(op['flood']/op['totalarea'])\n",
    "op = op.drop(columns=['system:index', 'dry', 'flood', 'totalarea', '.geo'])\n",
    "op = op.set_index('date')\n",
    "op.columns = ['flood_optical']\n",
    "\n",
    "\n",
    "# import files : radar\n",
    "ra =pd.read_csv(radarfilename)\n",
    "ra['date'] = pd.to_datetime(ra['date'])\n",
    "\n",
    "minimum_area = ra['totalarea'].max()*0.95\n",
    "\n",
    "ra = ra[ra['totalarea'] > minimum_area]\n",
    "\n",
    "ra['flooded'] = 100*(ra['flood']/ra['totalarea'])\n",
    "ra = ra.drop(columns=['system:index', 'dry', 'flood', 'totalarea','.geo'])\n",
    "ra = ra.set_index('date')\n",
    "ra.columns = ['flood_radar']\n",
    "#ra.tail()\n",
    "\n",
    "flood = ra.merge(op, how='outer', left_index=True, right_index=True)\n",
    "\n",
    "flood_op = op\n",
    "flood_op.columns = ['flood']\n",
    "\n",
    "flood_ra = ra \n",
    "flood_ra.columns = ['flood']\n",
    "\n",
    "flood_all = pd.concat([flood_op, flood_ra])\n",
    "flood_all = flood_all.groupby('date').mean()\n",
    "flood_all = flood_all.sort_index()   \n",
    "\n",
    "flood_all_ma = flood_all.rolling(center=False, window=3, min_periods=1).mean()\n",
    "\n",
    "#flood_all.tail()\n",
    "date_length = 2267\n",
    "\n",
    "daterange = pd.date_range(\"2015-01-01\", periods=date_length, freq='D')\n",
    "columns = ['empty']\n",
    " \n",
    "df = pd.DataFrame(index=range(0,date_length), columns=columns)\n",
    "df = df.fillna(0)\n",
    "df['date'] = daterange\n",
    "df = df.set_index('date')\n",
    "\n",
    "#df.tail()\n",
    "flood_daily = pd.merge(df, flood_all_ma, how='left', left_index=True, right_index=True)\n",
    "flood_daily = flood_daily.drop(columns = ['empty'])\n",
    "flood_daily = flood_daily.fillna(flood_daily.interpolate(method='linear')).rolling(center=False, window=3, min_periods=1).mean()\n",
    "\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>wl_KK</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>date</th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>1990-09-05</th>\n",
       "      <td>7.16</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1990-09-06</th>\n",
       "      <td>7.20</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1990-09-07</th>\n",
       "      <td>7.22</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1990-09-08</th>\n",
       "      <td>7.22</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1990-09-09</th>\n",
       "      <td>7.21</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "            wl_KK\n",
       "date             \n",
       "1990-09-05   7.16\n",
       "1990-09-06   7.20\n",
       "1990-09-07   7.22\n",
       "1990-09-08   7.22\n",
       "1990-09-09   7.21"
      ]
     },
     "execution_count": 4,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Calculate Water Levels  \n",
    "\n",
    "wl_long = pd.read_csv('wl_KK_smoothed.csv')\n",
    "wl_long['date'] = pd.to_datetime(wl_long['date'])\n",
    "wl_long['date'] = wl_long['date'].dt.strftime('%Y-%m-%d')\n",
    "wl_long.columns = ['date', 'wl_long']\n",
    "wl_long = wl_long.set_index('date')\n",
    "wl_long['wl_long'] = wl_long['wl_long']\n",
    "\n",
    "# for data availability comparison:\n",
    "wl_long.index = pd.to_datetime(wl_long.index)\n",
    "wl_long1 = wl_long.resample('d').mean()#*10 # <----------- multiply by 10 for vis.\n",
    "\n",
    "wl_KK_daily = wl_long1  \n",
    "wl_KK_daily.columns = ['wl_KK']\n",
    "\n",
    "#wl_KK_daily = wl_KK_daily.rolling(center=False, window=3, min_periods=1).mean().round(2)\n",
    "\n",
    "#wl_KK_daily.to_csv('wl_KK_smoothed.csv')\n",
    "\n",
    "wl_KK_daily.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "metadata": {},
   "outputs": [],
   "source": [
    "flood_daily = flood_daily.merge(wl_KK_daily, how='inner', left_index=True, right_index=True)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "metadata": {},
   "outputs": [],
   "source": [
    "flood_daily['date'] = flood_daily.index\n",
    "flood_daily = flood_daily[(flood_daily['date'])>'2017-01-01']"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>flood</th>\n",
       "      <th>wl_KK</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>flood</th>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.784674</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>wl_KK</th>\n",
       "      <td>0.784674</td>\n",
       "      <td>1.000000</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "          flood     wl_KK\n",
       "flood  1.000000  0.784674\n",
       "wl_KK  0.784674  1.000000"
      ]
     },
     "execution_count": 7,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "## correlation without shift: \n",
    "\n",
    "flood_daily.corr()\n",
    "\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 53,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>flood</th>\n",
       "      <th>wl_KK</th>\n",
       "      <th>shift_05</th>\n",
       "      <th>shift_06</th>\n",
       "      <th>shift_07</th>\n",
       "      <th>shift_08</th>\n",
       "      <th>shift_09</th>\n",
       "      <th>shift_10</th>\n",
       "      <th>shift_11</th>\n",
       "      <th>shift_12</th>\n",
       "      <th>...</th>\n",
       "      <th>shift_17</th>\n",
       "      <th>shift_18</th>\n",
       "      <th>shift_19</th>\n",
       "      <th>shift_20</th>\n",
       "      <th>shift_21</th>\n",
       "      <th>shift_22</th>\n",
       "      <th>shift_23</th>\n",
       "      <th>shift_24</th>\n",
       "      <th>shift_25</th>\n",
       "      <th>shift_26</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>flood</th>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.784674</td>\n",
       "      <td>0.990060</td>\n",
       "      <td>0.985996</td>\n",
       "      <td>0.981329</td>\n",
       "      <td>0.976115</td>\n",
       "      <td>0.970396</td>\n",
       "      <td>0.964205</td>\n",
       "      <td>0.957555</td>\n",
       "      <td>0.950457</td>\n",
       "      <td>...</td>\n",
       "      <td>0.908991</td>\n",
       "      <td>0.899656</td>\n",
       "      <td>0.890011</td>\n",
       "      <td>0.880075</td>\n",
       "      <td>0.869868</td>\n",
       "      <td>0.859405</td>\n",
       "      <td>0.848689</td>\n",
       "      <td>0.848689</td>\n",
       "      <td>0.826520</td>\n",
       "      <td>0.815098</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>wl_KK</th>\n",
       "      <td>0.784674</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.841748</td>\n",
       "      <td>0.851632</td>\n",
       "      <td>0.860975</td>\n",
       "      <td>0.869783</td>\n",
       "      <td>0.878037</td>\n",
       "      <td>0.885739</td>\n",
       "      <td>0.892888</td>\n",
       "      <td>0.899486</td>\n",
       "      <td>...</td>\n",
       "      <td>0.923800</td>\n",
       "      <td>0.927017</td>\n",
       "      <td>0.929730</td>\n",
       "      <td>0.931972</td>\n",
       "      <td>0.933764</td>\n",
       "      <td>0.935152</td>\n",
       "      <td>0.936150</td>\n",
       "      <td>0.936150</td>\n",
       "      <td>0.936963</td>\n",
       "      <td>0.936734</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>shift_05</th>\n",
       "      <td>0.990060</td>\n",
       "      <td>0.841748</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.999555</td>\n",
       "      <td>0.998277</td>\n",
       "      <td>0.996231</td>\n",
       "      <td>0.993488</td>\n",
       "      <td>0.990071</td>\n",
       "      <td>0.986010</td>\n",
       "      <td>0.981349</td>\n",
       "      <td>...</td>\n",
       "      <td>0.950544</td>\n",
       "      <td>0.943033</td>\n",
       "      <td>0.935118</td>\n",
       "      <td>0.926829</td>\n",
       "      <td>0.918190</td>\n",
       "      <td>0.909216</td>\n",
       "      <td>0.899916</td>\n",
       "      <td>0.899916</td>\n",
       "      <td>0.880404</td>\n",
       "      <td>0.870230</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>shift_06</th>\n",
       "      <td>0.985996</td>\n",
       "      <td>0.851632</td>\n",
       "      <td>0.999555</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.999555</td>\n",
       "      <td>0.998277</td>\n",
       "      <td>0.996231</td>\n",
       "      <td>0.993489</td>\n",
       "      <td>0.990072</td>\n",
       "      <td>0.986013</td>\n",
       "      <td>...</td>\n",
       "      <td>0.957640</td>\n",
       "      <td>0.950565</td>\n",
       "      <td>0.943059</td>\n",
       "      <td>0.935150</td>\n",
       "      <td>0.926867</td>\n",
       "      <td>0.918234</td>\n",
       "      <td>0.909266</td>\n",
       "      <td>0.909266</td>\n",
       "      <td>0.890367</td>\n",
       "      <td>0.880470</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>shift_07</th>\n",
       "      <td>0.981329</td>\n",
       "      <td>0.860975</td>\n",
       "      <td>0.998277</td>\n",
       "      <td>0.999555</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.999555</td>\n",
       "      <td>0.998277</td>\n",
       "      <td>0.996232</td>\n",
       "      <td>0.993490</td>\n",
       "      <td>0.990074</td>\n",
       "      <td>...</td>\n",
       "      <td>0.964284</td>\n",
       "      <td>0.957659</td>\n",
       "      <td>0.950589</td>\n",
       "      <td>0.943089</td>\n",
       "      <td>0.935185</td>\n",
       "      <td>0.926908</td>\n",
       "      <td>0.918282</td>\n",
       "      <td>0.918282</td>\n",
       "      <td>0.900030</td>\n",
       "      <td>0.890429</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>shift_08</th>\n",
       "      <td>0.976115</td>\n",
       "      <td>0.869783</td>\n",
       "      <td>0.996231</td>\n",
       "      <td>0.998277</td>\n",
       "      <td>0.999555</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.999555</td>\n",
       "      <td>0.998277</td>\n",
       "      <td>0.996232</td>\n",
       "      <td>0.993491</td>\n",
       "      <td>...</td>\n",
       "      <td>0.970467</td>\n",
       "      <td>0.964301</td>\n",
       "      <td>0.957681</td>\n",
       "      <td>0.950616</td>\n",
       "      <td>0.943121</td>\n",
       "      <td>0.935223</td>\n",
       "      <td>0.926951</td>\n",
       "      <td>0.926951</td>\n",
       "      <td>0.909373</td>\n",
       "      <td>0.900088</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>shift_09</th>\n",
       "      <td>0.970396</td>\n",
       "      <td>0.878037</td>\n",
       "      <td>0.993488</td>\n",
       "      <td>0.996231</td>\n",
       "      <td>0.998277</td>\n",
       "      <td>0.999555</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.999555</td>\n",
       "      <td>0.998278</td>\n",
       "      <td>0.996233</td>\n",
       "      <td>...</td>\n",
       "      <td>0.976178</td>\n",
       "      <td>0.970482</td>\n",
       "      <td>0.964320</td>\n",
       "      <td>0.957705</td>\n",
       "      <td>0.950645</td>\n",
       "      <td>0.943156</td>\n",
       "      <td>0.935263</td>\n",
       "      <td>0.935263</td>\n",
       "      <td>0.918380</td>\n",
       "      <td>0.909427</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>shift_10</th>\n",
       "      <td>0.964205</td>\n",
       "      <td>0.885739</td>\n",
       "      <td>0.990071</td>\n",
       "      <td>0.993489</td>\n",
       "      <td>0.996232</td>\n",
       "      <td>0.998277</td>\n",
       "      <td>0.999555</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.999555</td>\n",
       "      <td>0.998278</td>\n",
       "      <td>...</td>\n",
       "      <td>0.981384</td>\n",
       "      <td>0.976191</td>\n",
       "      <td>0.970500</td>\n",
       "      <td>0.964342</td>\n",
       "      <td>0.957731</td>\n",
       "      <td>0.950677</td>\n",
       "      <td>0.943193</td>\n",
       "      <td>0.943193</td>\n",
       "      <td>0.927043</td>\n",
       "      <td>0.918431</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>shift_11</th>\n",
       "      <td>0.957555</td>\n",
       "      <td>0.892888</td>\n",
       "      <td>0.986010</td>\n",
       "      <td>0.990072</td>\n",
       "      <td>0.993490</td>\n",
       "      <td>0.996232</td>\n",
       "      <td>0.998278</td>\n",
       "      <td>0.999555</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.999555</td>\n",
       "      <td>...</td>\n",
       "      <td>0.986041</td>\n",
       "      <td>0.981395</td>\n",
       "      <td>0.976206</td>\n",
       "      <td>0.970518</td>\n",
       "      <td>0.964365</td>\n",
       "      <td>0.957759</td>\n",
       "      <td>0.950710</td>\n",
       "      <td>0.950710</td>\n",
       "      <td>0.935347</td>\n",
       "      <td>0.927090</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>shift_12</th>\n",
       "      <td>0.950457</td>\n",
       "      <td>0.899486</td>\n",
       "      <td>0.981349</td>\n",
       "      <td>0.986013</td>\n",
       "      <td>0.990074</td>\n",
       "      <td>0.993491</td>\n",
       "      <td>0.996233</td>\n",
       "      <td>0.998278</td>\n",
       "      <td>0.999555</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>...</td>\n",
       "      <td>0.990096</td>\n",
       "      <td>0.986050</td>\n",
       "      <td>0.981407</td>\n",
       "      <td>0.976221</td>\n",
       "      <td>0.970537</td>\n",
       "      <td>0.964389</td>\n",
       "      <td>0.957788</td>\n",
       "      <td>0.957788</td>\n",
       "      <td>0.943267</td>\n",
       "      <td>0.935388</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>shift_13</th>\n",
       "      <td>0.942923</td>\n",
       "      <td>0.905512</td>\n",
       "      <td>0.976141</td>\n",
       "      <td>0.981353</td>\n",
       "      <td>0.986016</td>\n",
       "      <td>0.990077</td>\n",
       "      <td>0.993494</td>\n",
       "      <td>0.996234</td>\n",
       "      <td>0.998279</td>\n",
       "      <td>0.999555</td>\n",
       "      <td>...</td>\n",
       "      <td>0.993507</td>\n",
       "      <td>0.990102</td>\n",
       "      <td>0.986058</td>\n",
       "      <td>0.981418</td>\n",
       "      <td>0.976236</td>\n",
       "      <td>0.970557</td>\n",
       "      <td>0.964413</td>\n",
       "      <td>0.964413</td>\n",
       "      <td>0.950775</td>\n",
       "      <td>0.943303</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>shift_14</th>\n",
       "      <td>0.934983</td>\n",
       "      <td>0.910949</td>\n",
       "      <td>0.970433</td>\n",
       "      <td>0.976148</td>\n",
       "      <td>0.981359</td>\n",
       "      <td>0.986021</td>\n",
       "      <td>0.990081</td>\n",
       "      <td>0.993496</td>\n",
       "      <td>0.996236</td>\n",
       "      <td>0.998280</td>\n",
       "      <td>...</td>\n",
       "      <td>0.996242</td>\n",
       "      <td>0.993511</td>\n",
       "      <td>0.990108</td>\n",
       "      <td>0.986067</td>\n",
       "      <td>0.981430</td>\n",
       "      <td>0.976252</td>\n",
       "      <td>0.970577</td>\n",
       "      <td>0.970577</td>\n",
       "      <td>0.957842</td>\n",
       "      <td>0.950805</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>shift_15</th>\n",
       "      <td>0.926666</td>\n",
       "      <td>0.915794</td>\n",
       "      <td>0.964256</td>\n",
       "      <td>0.970443</td>\n",
       "      <td>0.976156</td>\n",
       "      <td>0.981366</td>\n",
       "      <td>0.986027</td>\n",
       "      <td>0.990085</td>\n",
       "      <td>0.993500</td>\n",
       "      <td>0.996238</td>\n",
       "      <td>...</td>\n",
       "      <td>0.998282</td>\n",
       "      <td>0.996245</td>\n",
       "      <td>0.993515</td>\n",
       "      <td>0.990114</td>\n",
       "      <td>0.986076</td>\n",
       "      <td>0.981443</td>\n",
       "      <td>0.976267</td>\n",
       "      <td>0.976267</td>\n",
       "      <td>0.964458</td>\n",
       "      <td>0.957867</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>shift_16</th>\n",
       "      <td>0.917997</td>\n",
       "      <td>0.920067</td>\n",
       "      <td>0.957623</td>\n",
       "      <td>0.964269</td>\n",
       "      <td>0.970454</td>\n",
       "      <td>0.976166</td>\n",
       "      <td>0.981374</td>\n",
       "      <td>0.986034</td>\n",
       "      <td>0.990091</td>\n",
       "      <td>0.993503</td>\n",
       "      <td>...</td>\n",
       "      <td>0.999556</td>\n",
       "      <td>0.998283</td>\n",
       "      <td>0.996247</td>\n",
       "      <td>0.993519</td>\n",
       "      <td>0.990121</td>\n",
       "      <td>0.986085</td>\n",
       "      <td>0.981454</td>\n",
       "      <td>0.981454</td>\n",
       "      <td>0.970613</td>\n",
       "      <td>0.964478</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>shift_17</th>\n",
       "      <td>0.908991</td>\n",
       "      <td>0.923800</td>\n",
       "      <td>0.950544</td>\n",
       "      <td>0.957640</td>\n",
       "      <td>0.964284</td>\n",
       "      <td>0.970467</td>\n",
       "      <td>0.976178</td>\n",
       "      <td>0.981384</td>\n",
       "      <td>0.986041</td>\n",
       "      <td>0.990096</td>\n",
       "      <td>...</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.999557</td>\n",
       "      <td>0.998284</td>\n",
       "      <td>0.996249</td>\n",
       "      <td>0.993523</td>\n",
       "      <td>0.990127</td>\n",
       "      <td>0.986094</td>\n",
       "      <td>0.986094</td>\n",
       "      <td>0.976296</td>\n",
       "      <td>0.970629</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>shift_18</th>\n",
       "      <td>0.899656</td>\n",
       "      <td>0.927017</td>\n",
       "      <td>0.943033</td>\n",
       "      <td>0.950565</td>\n",
       "      <td>0.957659</td>\n",
       "      <td>0.964301</td>\n",
       "      <td>0.970482</td>\n",
       "      <td>0.976191</td>\n",
       "      <td>0.981395</td>\n",
       "      <td>0.986050</td>\n",
       "      <td>...</td>\n",
       "      <td>0.999557</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.999557</td>\n",
       "      <td>0.998285</td>\n",
       "      <td>0.996251</td>\n",
       "      <td>0.993527</td>\n",
       "      <td>0.990133</td>\n",
       "      <td>0.990133</td>\n",
       "      <td>0.981476</td>\n",
       "      <td>0.976308</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>shift_19</th>\n",
       "      <td>0.890011</td>\n",
       "      <td>0.929730</td>\n",
       "      <td>0.935118</td>\n",
       "      <td>0.943059</td>\n",
       "      <td>0.950589</td>\n",
       "      <td>0.957681</td>\n",
       "      <td>0.964320</td>\n",
       "      <td>0.970500</td>\n",
       "      <td>0.976206</td>\n",
       "      <td>0.981407</td>\n",
       "      <td>...</td>\n",
       "      <td>0.998284</td>\n",
       "      <td>0.999557</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.999557</td>\n",
       "      <td>0.998286</td>\n",
       "      <td>0.996254</td>\n",
       "      <td>0.993531</td>\n",
       "      <td>0.993531</td>\n",
       "      <td>0.986109</td>\n",
       "      <td>0.981485</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>shift_20</th>\n",
       "      <td>0.880075</td>\n",
       "      <td>0.931972</td>\n",
       "      <td>0.926829</td>\n",
       "      <td>0.935150</td>\n",
       "      <td>0.943089</td>\n",
       "      <td>0.950616</td>\n",
       "      <td>0.957705</td>\n",
       "      <td>0.964342</td>\n",
       "      <td>0.970518</td>\n",
       "      <td>0.976221</td>\n",
       "      <td>...</td>\n",
       "      <td>0.996249</td>\n",
       "      <td>0.998285</td>\n",
       "      <td>0.999557</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.999557</td>\n",
       "      <td>0.998287</td>\n",
       "      <td>0.996256</td>\n",
       "      <td>0.996256</td>\n",
       "      <td>0.990143</td>\n",
       "      <td>0.986116</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>shift_21</th>\n",
       "      <td>0.869868</td>\n",
       "      <td>0.933764</td>\n",
       "      <td>0.918190</td>\n",
       "      <td>0.926867</td>\n",
       "      <td>0.935185</td>\n",
       "      <td>0.943121</td>\n",
       "      <td>0.950645</td>\n",
       "      <td>0.957731</td>\n",
       "      <td>0.964365</td>\n",
       "      <td>0.970537</td>\n",
       "      <td>...</td>\n",
       "      <td>0.993523</td>\n",
       "      <td>0.996251</td>\n",
       "      <td>0.998286</td>\n",
       "      <td>0.999557</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.999558</td>\n",
       "      <td>0.998288</td>\n",
       "      <td>0.998288</td>\n",
       "      <td>0.993537</td>\n",
       "      <td>0.990148</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>shift_22</th>\n",
       "      <td>0.859405</td>\n",
       "      <td>0.935152</td>\n",
       "      <td>0.909216</td>\n",
       "      <td>0.918234</td>\n",
       "      <td>0.926908</td>\n",
       "      <td>0.935223</td>\n",
       "      <td>0.943156</td>\n",
       "      <td>0.950677</td>\n",
       "      <td>0.957759</td>\n",
       "      <td>0.964389</td>\n",
       "      <td>...</td>\n",
       "      <td>0.990127</td>\n",
       "      <td>0.993527</td>\n",
       "      <td>0.996254</td>\n",
       "      <td>0.998287</td>\n",
       "      <td>0.999558</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.999558</td>\n",
       "      <td>0.999558</td>\n",
       "      <td>0.996259</td>\n",
       "      <td>0.993539</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>shift_23</th>\n",
       "      <td>0.848689</td>\n",
       "      <td>0.936150</td>\n",
       "      <td>0.899916</td>\n",
       "      <td>0.909266</td>\n",
       "      <td>0.918282</td>\n",
       "      <td>0.926951</td>\n",
       "      <td>0.935263</td>\n",
       "      <td>0.943193</td>\n",
       "      <td>0.950710</td>\n",
       "      <td>0.957788</td>\n",
       "      <td>...</td>\n",
       "      <td>0.986094</td>\n",
       "      <td>0.990133</td>\n",
       "      <td>0.993531</td>\n",
       "      <td>0.996256</td>\n",
       "      <td>0.998288</td>\n",
       "      <td>0.999558</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.998290</td>\n",
       "      <td>0.996260</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>shift_24</th>\n",
       "      <td>0.848689</td>\n",
       "      <td>0.936150</td>\n",
       "      <td>0.899916</td>\n",
       "      <td>0.909266</td>\n",
       "      <td>0.918282</td>\n",
       "      <td>0.926951</td>\n",
       "      <td>0.935263</td>\n",
       "      <td>0.943193</td>\n",
       "      <td>0.950710</td>\n",
       "      <td>0.957788</td>\n",
       "      <td>...</td>\n",
       "      <td>0.986094</td>\n",
       "      <td>0.990133</td>\n",
       "      <td>0.993531</td>\n",
       "      <td>0.996256</td>\n",
       "      <td>0.998288</td>\n",
       "      <td>0.999558</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.998290</td>\n",
       "      <td>0.996260</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>shift_25</th>\n",
       "      <td>0.826520</td>\n",
       "      <td>0.936963</td>\n",
       "      <td>0.880404</td>\n",
       "      <td>0.890367</td>\n",
       "      <td>0.900030</td>\n",
       "      <td>0.909373</td>\n",
       "      <td>0.918380</td>\n",
       "      <td>0.927043</td>\n",
       "      <td>0.935347</td>\n",
       "      <td>0.943267</td>\n",
       "      <td>...</td>\n",
       "      <td>0.976296</td>\n",
       "      <td>0.981476</td>\n",
       "      <td>0.986109</td>\n",
       "      <td>0.990143</td>\n",
       "      <td>0.993537</td>\n",
       "      <td>0.996259</td>\n",
       "      <td>0.998290</td>\n",
       "      <td>0.998290</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.999558</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>shift_26</th>\n",
       "      <td>0.815098</td>\n",
       "      <td>0.936734</td>\n",
       "      <td>0.870230</td>\n",
       "      <td>0.880470</td>\n",
       "      <td>0.890429</td>\n",
       "      <td>0.900088</td>\n",
       "      <td>0.909427</td>\n",
       "      <td>0.918431</td>\n",
       "      <td>0.927090</td>\n",
       "      <td>0.935388</td>\n",
       "      <td>...</td>\n",
       "      <td>0.970629</td>\n",
       "      <td>0.976308</td>\n",
       "      <td>0.981485</td>\n",
       "      <td>0.986116</td>\n",
       "      <td>0.990148</td>\n",
       "      <td>0.993539</td>\n",
       "      <td>0.996260</td>\n",
       "      <td>0.996260</td>\n",
       "      <td>0.999558</td>\n",
       "      <td>1.000000</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>24 rows Ã— 24 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "             flood     wl_KK  shift_05  shift_06  shift_07  shift_08  \\\n",
       "flood     1.000000  0.784674  0.990060  0.985996  0.981329  0.976115   \n",
       "wl_KK     0.784674  1.000000  0.841748  0.851632  0.860975  0.869783   \n",
       "shift_05  0.990060  0.841748  1.000000  0.999555  0.998277  0.996231   \n",
       "shift_06  0.985996  0.851632  0.999555  1.000000  0.999555  0.998277   \n",
       "shift_07  0.981329  0.860975  0.998277  0.999555  1.000000  0.999555   \n",
       "shift_08  0.976115  0.869783  0.996231  0.998277  0.999555  1.000000   \n",
       "shift_09  0.970396  0.878037  0.993488  0.996231  0.998277  0.999555   \n",
       "shift_10  0.964205  0.885739  0.990071  0.993489  0.996232  0.998277   \n",
       "shift_11  0.957555  0.892888  0.986010  0.990072  0.993490  0.996232   \n",
       "shift_12  0.950457  0.899486  0.981349  0.986013  0.990074  0.993491   \n",
       "shift_13  0.942923  0.905512  0.976141  0.981353  0.986016  0.990077   \n",
       "shift_14  0.934983  0.910949  0.970433  0.976148  0.981359  0.986021   \n",
       "shift_15  0.926666  0.915794  0.964256  0.970443  0.976156  0.981366   \n",
       "shift_16  0.917997  0.920067  0.957623  0.964269  0.970454  0.976166   \n",
       "shift_17  0.908991  0.923800  0.950544  0.957640  0.964284  0.970467   \n",
       "shift_18  0.899656  0.927017  0.943033  0.950565  0.957659  0.964301   \n",
       "shift_19  0.890011  0.929730  0.935118  0.943059  0.950589  0.957681   \n",
       "shift_20  0.880075  0.931972  0.926829  0.935150  0.943089  0.950616   \n",
       "shift_21  0.869868  0.933764  0.918190  0.926867  0.935185  0.943121   \n",
       "shift_22  0.859405  0.935152  0.909216  0.918234  0.926908  0.935223   \n",
       "shift_23  0.848689  0.936150  0.899916  0.909266  0.918282  0.926951   \n",
       "shift_24  0.848689  0.936150  0.899916  0.909266  0.918282  0.926951   \n",
       "shift_25  0.826520  0.936963  0.880404  0.890367  0.900030  0.909373   \n",
       "shift_26  0.815098  0.936734  0.870230  0.880470  0.890429  0.900088   \n",
       "\n",
       "          shift_09  shift_10  shift_11  shift_12  ...  shift_17  shift_18  \\\n",
       "flood     0.970396  0.964205  0.957555  0.950457  ...  0.908991  0.899656   \n",
       "wl_KK     0.878037  0.885739  0.892888  0.899486  ...  0.923800  0.927017   \n",
       "shift_05  0.993488  0.990071  0.986010  0.981349  ...  0.950544  0.943033   \n",
       "shift_06  0.996231  0.993489  0.990072  0.986013  ...  0.957640  0.950565   \n",
       "shift_07  0.998277  0.996232  0.993490  0.990074  ...  0.964284  0.957659   \n",
       "shift_08  0.999555  0.998277  0.996232  0.993491  ...  0.970467  0.964301   \n",
       "shift_09  1.000000  0.999555  0.998278  0.996233  ...  0.976178  0.970482   \n",
       "shift_10  0.999555  1.000000  0.999555  0.998278  ...  0.981384  0.976191   \n",
       "shift_11  0.998278  0.999555  1.000000  0.999555  ...  0.986041  0.981395   \n",
       "shift_12  0.996233  0.998278  0.999555  1.000000  ...  0.990096  0.986050   \n",
       "shift_13  0.993494  0.996234  0.998279  0.999555  ...  0.993507  0.990102   \n",
       "shift_14  0.990081  0.993496  0.996236  0.998280  ...  0.996242  0.993511   \n",
       "shift_15  0.986027  0.990085  0.993500  0.996238  ...  0.998282  0.996245   \n",
       "shift_16  0.981374  0.986034  0.990091  0.993503  ...  0.999556  0.998283   \n",
       "shift_17  0.976178  0.981384  0.986041  0.990096  ...  1.000000  0.999557   \n",
       "shift_18  0.970482  0.976191  0.981395  0.986050  ...  0.999557  1.000000   \n",
       "shift_19  0.964320  0.970500  0.976206  0.981407  ...  0.998284  0.999557   \n",
       "shift_20  0.957705  0.964342  0.970518  0.976221  ...  0.996249  0.998285   \n",
       "shift_21  0.950645  0.957731  0.964365  0.970537  ...  0.993523  0.996251   \n",
       "shift_22  0.943156  0.950677  0.957759  0.964389  ...  0.990127  0.993527   \n",
       "shift_23  0.935263  0.943193  0.950710  0.957788  ...  0.986094  0.990133   \n",
       "shift_24  0.935263  0.943193  0.950710  0.957788  ...  0.986094  0.990133   \n",
       "shift_25  0.918380  0.927043  0.935347  0.943267  ...  0.976296  0.981476   \n",
       "shift_26  0.909427  0.918431  0.927090  0.935388  ...  0.970629  0.976308   \n",
       "\n",
       "          shift_19  shift_20  shift_21  shift_22  shift_23  shift_24  \\\n",
       "flood     0.890011  0.880075  0.869868  0.859405  0.848689  0.848689   \n",
       "wl_KK     0.929730  0.931972  0.933764  0.935152  0.936150  0.936150   \n",
       "shift_05  0.935118  0.926829  0.918190  0.909216  0.899916  0.899916   \n",
       "shift_06  0.943059  0.935150  0.926867  0.918234  0.909266  0.909266   \n",
       "shift_07  0.950589  0.943089  0.935185  0.926908  0.918282  0.918282   \n",
       "shift_08  0.957681  0.950616  0.943121  0.935223  0.926951  0.926951   \n",
       "shift_09  0.964320  0.957705  0.950645  0.943156  0.935263  0.935263   \n",
       "shift_10  0.970500  0.964342  0.957731  0.950677  0.943193  0.943193   \n",
       "shift_11  0.976206  0.970518  0.964365  0.957759  0.950710  0.950710   \n",
       "shift_12  0.981407  0.976221  0.970537  0.964389  0.957788  0.957788   \n",
       "shift_13  0.986058  0.981418  0.976236  0.970557  0.964413  0.964413   \n",
       "shift_14  0.990108  0.986067  0.981430  0.976252  0.970577  0.970577   \n",
       "shift_15  0.993515  0.990114  0.986076  0.981443  0.976267  0.976267   \n",
       "shift_16  0.996247  0.993519  0.990121  0.986085  0.981454  0.981454   \n",
       "shift_17  0.998284  0.996249  0.993523  0.990127  0.986094  0.986094   \n",
       "shift_18  0.999557  0.998285  0.996251  0.993527  0.990133  0.990133   \n",
       "shift_19  1.000000  0.999557  0.998286  0.996254  0.993531  0.993531   \n",
       "shift_20  0.999557  1.000000  0.999557  0.998287  0.996256  0.996256   \n",
       "shift_21  0.998286  0.999557  1.000000  0.999558  0.998288  0.998288   \n",
       "shift_22  0.996254  0.998287  0.999558  1.000000  0.999558  0.999558   \n",
       "shift_23  0.993531  0.996256  0.998288  0.999558  1.000000  1.000000   \n",
       "shift_24  0.993531  0.996256  0.998288  0.999558  1.000000  1.000000   \n",
       "shift_25  0.986109  0.990143  0.993537  0.996259  0.998290  0.998290   \n",
       "shift_26  0.981485  0.986116  0.990148  0.993539  0.996260  0.996260   \n",
       "\n",
       "          shift_25  shift_26  \n",
       "flood     0.826520  0.815098  \n",
       "wl_KK     0.936963  0.936734  \n",
       "shift_05  0.880404  0.870230  \n",
       "shift_06  0.890367  0.880470  \n",
       "shift_07  0.900030  0.890429  \n",
       "shift_08  0.909373  0.900088  \n",
       "shift_09  0.918380  0.909427  \n",
       "shift_10  0.927043  0.918431  \n",
       "shift_11  0.935347  0.927090  \n",
       "shift_12  0.943267  0.935388  \n",
       "shift_13  0.950775  0.943303  \n",
       "shift_14  0.957842  0.950805  \n",
       "shift_15  0.964458  0.957867  \n",
       "shift_16  0.970613  0.964478  \n",
       "shift_17  0.976296  0.970629  \n",
       "shift_18  0.981476  0.976308  \n",
       "shift_19  0.986109  0.981485  \n",
       "shift_20  0.990143  0.986116  \n",
       "shift_21  0.993537  0.990148  \n",
       "shift_22  0.996259  0.993539  \n",
       "shift_23  0.998290  0.996260  \n",
       "shift_24  0.998290  0.996260  \n",
       "shift_25  1.000000  0.999558  \n",
       "shift_26  0.999558  1.000000  \n",
       "\n",
       "[24 rows x 24 columns]"
      ]
     },
     "execution_count": 53,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# correlations shift: \n",
    "\n",
    "flooded_daily = flood_daily\n",
    "\n",
    "flooded_daily['shift_05'] = flooded_daily['flood'].shift(-5)\n",
    "flooded_daily['shift_06'] = flooded_daily['flood'].shift(-6)\n",
    "flooded_daily['shift_07'] = flooded_daily['flood'].shift(-7)\n",
    "flooded_daily['shift_08'] = flooded_daily['flood'].shift(-8)\n",
    "flooded_daily['shift_09'] = flooded_daily['flood'].shift(-9)\n",
    "flooded_daily['shift_10'] = flooded_daily['flood'].shift(-10)\n",
    "flooded_daily['shift_11'] = flooded_daily['flood'].shift(-11)\n",
    "flooded_daily['shift_12'] = flooded_daily['flood'].shift(-12)\n",
    "flooded_daily['shift_13'] = flooded_daily['flood'].shift(-13)\n",
    "flooded_daily['shift_14'] = flooded_daily['flood'].shift(-14)\n",
    "flooded_daily['shift_15'] = flooded_daily['flood'].shift(-15)\n",
    "flooded_daily['shift_16'] = flooded_daily['flood'].shift(-16)\n",
    "flooded_daily['shift_17'] = flooded_daily['flood'].shift(-17)\n",
    "flooded_daily['shift_18'] = flooded_daily['flood'].shift(-18)\n",
    "flooded_daily['shift_19'] = flooded_daily['flood'].shift(-19)\n",
    "flooded_daily['shift_20'] = flooded_daily['flood'].shift(-20)\n",
    "flooded_daily['shift_21'] = flooded_daily['flood'].shift(-21)\n",
    "flooded_daily['shift_22'] = flooded_daily['flood'].shift(-22)\n",
    "flooded_daily['shift_23'] = flooded_daily['flood'].shift(-23)\n",
    "flooded_daily['shift_24'] = flooded_daily['flood'].shift(-23)\n",
    "flooded_daily['shift_25'] = flooded_daily['flood'].shift(-25)\n",
    "flooded_daily['shift_26'] = flooded_daily['flood'].shift(-26)\n",
    "\n",
    "flooded_daily.corr()\n",
    "\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.7.6"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 4
}
